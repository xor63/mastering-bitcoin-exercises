<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Mastering Bitcoin Exercises</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="custom.css">
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li class="affix"><a href="ch00-title-page.html">Mastering Bitcoin Exercises</a></li><li><a href="ch01-introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><a href="ch02-how-bitcoin-works.html"><strong aria-hidden="true">2.</strong> How Bitcoin Works</a></li><li><a href="ch03-bitcoin-core-the-reference-implementation.html"><strong aria-hidden="true">3.</strong> Bitcoin Core: The Reference Implementation</a></li><li><a href="ch04-keys-addresses.html"><strong aria-hidden="true">4.</strong> Keys, Addresses</a></li><li><a href="ch05-wallets.html"><strong aria-hidden="true">5.</strong> Wallets</a></li><li><a href="ch06-transactions.html"><strong aria-hidden="true">6.</strong> Transactions</a></li><li><a href="ch07-advanced-transactions-and-scripting.html"><strong aria-hidden="true">7.</strong> Advanced Transactions and Scripting</a></li><li><a href="ch08-the-bitcoin-network.html"><strong aria-hidden="true">8.</strong> The Bitcoin Network</a></li><li><a href="ch09-the-blockchain.html"><strong aria-hidden="true">9.</strong> The Blockchain</a></li><li><a href="ch10-mining-and-consensus.html"><strong aria-hidden="true">10.</strong> Mining and Consensus</a></li><li><a href="ch11-bitcoin-security.html"><strong aria-hidden="true">11.</strong> Bitcoin Security</a></li><li><a href="ch12-blockchain-applications.html"><strong aria-hidden="true">12.</strong> Blockchain Applications</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Mastering Bitcoin Exercises</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#mastering-bitcoin-exercises" id="mastering-bitcoin-exercises"><h1>Mastering Bitcoin Exercises</h1></a>
<p>Welcome to the Mastering Bitcoin Exercises workbook! This book provides
supplementary exercises to the book <a href="https://amzn.to/2xcdsY9">Mastering Bitcoin 2nd Edition</a> by
Andreas M. Antonopoulos.</p>
<a class="header" href="#how-this-book-is-organized" id="how-this-book-is-organized"><h2>How This Book is Organized</h2></a>
<p>The exercises in this book are simply grouped by the chapters of the Mastering
Bitcoin 2nd Edition.</p>
<a class="header" href="#license" id="license"><h2>License</h2></a>
<p>&quot;Mastering Bitcoin - Second Edition&quot; by <a href="https://antonopoulos.com/">Andreas M. Antonopoulos LLC</a>
is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.</p>
<p><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></p>
<p>&quot;Mastering Bitcoin Exercises&quot; is therefore also licensed under a
<a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<a class="header" href="#1-introduction" id="1-introduction"><h1>1. Introduction</h1></a>
<a class="header" href="#11-digital-signature-with-openssl" id="11-digital-signature-with-openssl"><h3>1.1 Digital signature with OpenSSL</h3></a>
<p>Use the <code>openssl</code> command-line tool to create an RSA key pair and to sign and
verify a text file.</p>
<ol>
<li>Prepare an arbitrary text file to be signed.</li>
<li>Generate an RSA private key with key length of 2048 bits.</li>
<li>Extract the public key from the private key.</li>
<li>Sign the text file using SHA256 and your private key, and output a signature
file.</li>
<li>Verify the signature of the text file using the public key.</li>
</ol>
<a class="header" href="#12-a-simple-qr-code" id="12-a-simple-qr-code"><h3>1.2 A simple QR code</h3></a>
<p>Use a QR code generator to generate a QR code that simply contains the text
&quot;hi&quot;. Identify the different parts of the QR code such as the positioning
markings, the format information, the timing pattern, and so on. If you can,
find where the &quot;h&quot; and &quot;i&quot; is located in the grid of black and white.</p>
<a class="header" href="#2-how-bitcoin-works" id="2-how-bitcoin-works"><h1>2. How Bitcoin Works</h1></a>
<a class="header" href="#21-payment-request-qr-code" id="21-payment-request-qr-code"><h3>2.1 Payment request QR code</h3></a>
<p>Construct a QR code for a payment request with the following details:</p>
<ul>
<li>Bitcoin address: &quot;mrCDrCybB6J1vRfbwM5hemdJz73FwDBC8r&quot;</li>
<li>Amount: &quot;0.00001&quot;</li>
<li>Label: &quot;Blips and Chitz&quot;</li>
<li>Message: &quot;Purchase tokens at Blips and Chitz&quot;</li>
</ul>
<p>Scan the QR code with a QR code reader to verify its contents.</p>
<p><strong>Reading</strong>: <a href="https://github.com/bitcoin/bips/blob/master/bip-0021.mediawiki">BIP-21</a> is a short proposal that describes the URI scheme
used in payment request QR codes.</p>
<a class="header" href="#22-cryptographic-hash-puzzle" id="22-cryptographic-hash-puzzle"><h3>2.2 Cryptographic hash puzzle</h3></a>
<p>Repeatedly compute the SHA256 hash of the following simplified header (in JSON),
incrementing the nonce in every iteration, until the resulting hash starts with
three consecutive zeros.</p>
<pre><code class="language-json">{
  &quot;height&quot;: 0,
  &quot;version&quot;: 1,
  &quot;merkleroot&quot;: &quot;4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b&quot;,
  &quot;nonce&quot; : 0
}
</code></pre>
<a class="header" href="#3-bitcoin-core-the-reference-implementation" id="3-bitcoin-core-the-reference-implementation"><h1>3. Bitcoin Core: The Reference Implementation</h1></a>
<p>Chapter 3 of the book Mastering Bitcoin 2nd Edition is a highly technical
chapter for setting up a development environment. It walks you through compiling
Bitcoin Core and configuring/running your own node. If you follow the steps and
explore the help documentation as described in the chapter, there's more than
enough exercises to work on.</p>
<p>The last section of that chapter is Alternative Clients, Libraries and Toolkits.
It lists some libraries, clients and toolkits grouped by programming language.
We can work on exercises that use any of these to expand on this chapter. With
your programming language of choice, select the software in the list that you
would like to explore and see if you can do any of the exercises below.</p>
<a class="header" href="#31-decode-raw-transaction" id="31-decode-raw-transaction"><h3>3.1 Decode Raw Transaction</h3></a>
<p>Using a client library, decode Alice's coffee transaction with the following
transaction ID:</p>
<pre><code>0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2
</code></pre>
<p>Depending on the library, you may have to initially obtain a serialized
transaction that you will then have to decode, or you may directly get a
human-readable format of the transaction.</p>
<p>Check that you can see the same transaction inputs and outputs as in the book.</p>
<a class="header" href="#4-keys-addresses" id="4-keys-addresses"><h1>4. Keys, Addresses</h1></a>
<a class="header" href="#41-generate-a-private-key" id="41-generate-a-private-key"><h3>4.1 Generate a private key</h3></a>
<p>Your program should use a cryptographically secure pseudorandom number generator
(CSPRNG) to generate random bits with sufficient entropy (at least 256 bits) and
compute its SHA256 hash. Repeat this process in a loop until the value is less
than the prime p as defined in the secp256k1 standard:</p>
<pre>
    p = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFC2F<br>
      = 2<sup>256</sup> - 2<sup>32</sup> - 2<sup>9</sup> - 2<sup>8</sup> - 2<sup>7</sup> - 2<sup>6</sup> - 2<sup>4</sup> - 1
</pre>
<p>Some programming languages may require a bignum library for dealing with very
large numbers.</p>
<p><strong>Reading</strong>: You may need to read more about entropy to make sure that your
random number has sufficient entropy. Different operating systems have different
sources of entropy.</p>
<a class="header" href="#42-confirm-point-is-on-the-elliptic-curve" id="42-confirm-point-is-on-the-elliptic-curve"><h3>4.2 Confirm point is on the elliptic curve</h3></a>
<p>In the Elliptic Curve Cryptography Explained section of the book, the following
example point P with coordinates (x, y) on the secp256k1 curve is given:</p>
<pre><code>P = (55066263022277343669578718895168534326250603453777594175500187360389116729240, 32670510020758816978083085130507043184471273380659243275938904335757337482424)
</code></pre>
<p>The book then provides a sample Python code to confirm that the point is on the
elliptic curve:</p>
<pre><code class="language-python">p = 115792089237316195423570985008687907853269984665640564039457584007908834671663
x = 55066263022277343669578718895168534326250603453777594175500187360389116729240
y = 32670510020758816978083085130507043184471273380659243275938904335757337482424
(x ** 3 + 7 - y**2) % p
</code></pre>
<p>If you're using a different programming language, write a similar program to do
the same. Make sure that your program can handle very large signed integers. The
secp256k1 curve is defined by the following function that you should use in your
program:</p>
<pre>
    y<sup>2</sup> mod p = (x<sup>3</sup> + 7) mod p
</pre>
<a class="header" href="#43-generate-a-public-key-with-openssl" id="43-generate-a-public-key-with-openssl"><h3>4.3 Generate a public key with OpenSSL</h3></a>
<p>Use the OpenSSL cryptographic library's <code>EC_POINT_mul()</code> to generate a public
key. You can use the private key that you have generated in exercise 4.1 or
alternatively, use the example private key from the book:</p>
<pre><code>1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD
</code></pre>
<p>Use the library's elliptic curve point multiplication to multiply the private
key with the generator point G in order to produce the public key K.</p>
<pre>
    K = k * G
</pre>
<p>Remember that Bitcoin uses a specific elliptic curve and set of constants
defined in a standard called <a href="https://en.bitcoin.it/wiki/Secp256k1">secp256k1</a>. From the Standards for
Efficient Cryptography (SEC), the base point G in compressed form is:</p>
<pre><code>G = 02 79BE667E F9DCBBAC 55A06295 CE870B07 029BFCDB 2DCE28D9 59F2815B 16F81798
</code></pre>
<p>and in uncompressed form is:</p>
<pre><code>G = 04 79BE667E F9DCBBAC 55A06295 CE870B07 029BFCDB 2DCE28D9 59F2815B 16F81798
       483ADA77 26A3C465 5DA4FBFC 0E1108A8 FD17B448 A6855419 9C47D08F FB10D4B8
</code></pre>
<a class="header" href="#44-convert-a-public-key-into-a-bitcoin-address" id="44-convert-a-public-key-into-a-bitcoin-address"><h3>4.4 Convert a public key into a bitcoin address</h3></a>
<p>Using the public key generated from the previous exercise, compute its SHA256
hash and then compute the RIPEMD160 hash of the result to produce a 160-bit
bitcoin address.</p>
<pre>
    A = RIPEMD160(SHA256(K))
</pre>
<p>This double-hash function is called HASH160.</p>
<a class="header" href="#5-wallets" id="5-wallets"><h1>5. Wallets</h1></a>
<a class="header" href="#51-generate-mnemonic-words" id="51-generate-mnemonic-words"><h3>5.1 Generate mnemonic words</h3></a>
<p>Write a program to generate and print mnemonic words from a given random
sequence of bits.</p>
<ol>
<li>Create a random sequence (entropy) of 128/160/192/224/256 bits.</li>
<li>Compute the SHA256 hash of the random sequence. Take the first
(entropy-length/32) bits of its hash as the checksum.</li>
<li>Concatenate the random sequence and the checksum.</li>
<li>Divide the result into sections of 11 bits.</li>
<li>Map each 11-bit value to a word from the predefined dictionary of 2048 words.</li>
<li>Print the mnemonic words in the correct order.</li>
</ol>
<p>Table 5-1: Checksum bits and number of mnemonic words depend on length of
entropy.</p>
<table><thead><tr><th align="center"> Entropy (bits) </th><th align="center"> Checksum (bits) </th><th align="center"> Mnemonic length (words) </th></tr></thead><tbody>
<tr><td align="center"> 128            </td><td align="center"> 4               </td><td align="center"> 12                      </td></tr>
<tr><td align="center"> 160            </td><td align="center"> 5               </td><td align="center"> 15                      </td></tr>
<tr><td align="center"> 192            </td><td align="center"> 6               </td><td align="center"> 18                      </td></tr>
<tr><td align="center"> 224            </td><td align="center"> 7               </td><td align="center"> 21                      </td></tr>
<tr><td align="center"> 256            </td><td align="center"> 8               </td><td align="center"> 24                      </td></tr>
</tbody></table>
<p>Get the dictionary/wordlist from <a href="https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki">BIP-39</a>. There's a section that
describes the characteristics of an ideal wordlist, and a separate section that
links to the actual wordlists.</p>
<a class="header" href="#52-pbkdf2" id="52-pbkdf2"><h3>5.2 PBKDF2</h3></a>
<p>Password-Based Key Derivation Function 2 (<a href="https://en.wikipedia.org/wiki/PBKDF2">PBKDF2</a>) is a key derivation
function to make brute force attacks more difficult with
<a href="https://en.wikipedia.org/wiki/Key_stretching">key stretching</a>.</p>
<pre>
    DK = PBKDF2(PRF, Password, Salt, c, dkLen)
</pre>
<p>Given the following parameters, use a PBKDF2 library to derive a key:</p>
<ul>
<li><code>c</code> (number of rounds): 4096</li>
<li><code>PRF</code> (pseudorandom function): HMAC-SHA256</li>
<li><code>dkLen</code> (derived key length): 256</li>
</ul>
<p>The PBKDF2 key derivation function takes two more parameters: a password, and a
salt. For this exercise, you can choose arbitrary values for these two.</p>
<a class="header" href="#6-transactions" id="6-transactions"><h1>6. Transactions</h1></a>
<a class="header" href="#7-advanced-transactions-and-scripting" id="7-advanced-transactions-and-scripting"><h1>7. Advanced Transactions and Scripting</h1></a>
<a class="header" href="#8-the-bitcoin-network" id="8-the-bitcoin-network"><h1>8. The Bitcoin Network</h1></a>
<a class="header" href="#9-the-blockchain" id="9-the-blockchain"><h1>9. The Blockchain</h1></a>
<a class="header" href="#10-mining-and-consensus" id="10-mining-and-consensus"><h1>10. Mining and Consensus</h1></a>
<a class="header" href="#11-bitcoin-security" id="11-bitcoin-security"><h1>11. Bitcoin Security</h1></a>
<a class="header" href="#12-blockchain-applications" id="12-blockchain-applications"><h1>12. Blockchain Applications</h1></a>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3001");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload(true); // force reload from server (not from cache)
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        
        <!-- Google Analytics Tag -->
        <script type="text/javascript">
            var localAddrs = ["localhost", "127.0.0.1", ""];

            // make sure we don't activate google analytics if the developer is
            // inspecting the book locally...
            if (localAddrs.indexOf(document.location.hostname) === -1) {
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-142494091-1', 'auto');
                ga('send', 'pageview');
            }
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
